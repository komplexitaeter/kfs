<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Running Bot</title>
</head>
<body>
<div id="simulation_id"></div>
<div id="session_key"></div>
<div id="fetch_count"></div>
<div id="last_execution_time"></div>
<div id="console"></div>
<script>
    let last_execution_time = '';
    let fetch_count = 0;

    function getParam(param_name){
        let url = new URL(window.location.href);
        let c = url.searchParams.get(param_name);
        return c;
    }

    function refreshBoard(simulation_id, session_key) {

        let url = './get_board.php?simulation_id=' + simulation_id
            + '&session_key=' + session_key
            + '&execution_time=' + last_execution_time;

        let start_time = new Date().getMilliseconds()

        fetch(url)
            .then((response) => {
                last_execution_time = new Date().getMilliseconds() - start_time;
                document.getElementById("last_execution_time").textContent = "last_execution_time: "+last_execution_time;
                document.getElementById("console").textContent += ". ";
                fetch_count++;
                document.getElementById("fetch_count").textContent = "fetch_count:" + fetch_count.toString();
            });
    }

    document.getElementById("simulation_id").textContent = "simulation_id: "+getParam("simulation_id");
    document.getElementById("session_key").textContent = "session_key: "+getParam("session_key");

    setInterval(function(){
        refreshBoard(getParam("simulation_id"), getParam("session_key"));
    }, 500);


</script>
</body>
</html>